<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Dashboard — LSP</title>

  <style>
    :root{--o:#FF6700;--s:#F7F7F7}
    body{margin:0;font-family:Inter,system-ui,Arial;color:var(--s);background:linear-gradient(180deg,#262b31 0%,#2e3640 100%)}
    .top{display:flex;align-items:center;gap:.75rem;padding:.7rem 1rem;border-bottom:1px solid rgba(255,255,255,.08);background:rgba(28,28,28,.5)}
    .brand{font-size:1.45rem;font-weight:800}
    .right{margin-left:auto;display:flex;gap:.6rem;align-items:center}
    .btn{border:0;border-radius:999px;padding:.45rem .8rem;font-weight:800;cursor:pointer;color:#fff;background:#FF6700}
    .ghost{background:transparent;box-shadow:0 0 0 2px #FF6700 inset}
    .wrap{max-width:1200px;margin:0 auto;padding:1rem}
    .cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:1rem}
    .card{background:rgba(0,0,0,.35);border:2px solid #FF6700;border-radius:1rem;padding:1rem}
    table{width:100%;border-collapse:collapse}
    th,td{padding:.5rem;border-bottom:1px solid rgba(255,255,255,.1)}
    footer{margin-top:2rem;padding:1rem 0;opacity:.8;text-align:center}
  </style>

  <!-- Router shim (keeps role-aware redirects) -->
  <script type="module" src="/js/dashboard_choice_respect_v58.js"></script>

  <!-- Unified Output Panel (shared) -->
  <script type="module" src="/js/output_panel_v1.js"></script>
  <script type="module" src="/js/wire_output_v60.js"></script>
</head>
<body>
  <header class="top">
    <div class="brand">Clarion Location Services — LSP</div>
    <div class="right">
      Signed in: <strong id="clrUserName"></strong> — <span id="clrUserEmail"></span>
      <button id="btnOpenChat" class="btn ghost">Chat</button>
      <button id="clrSignOut" class="btn">Sign out</button>
    </div>
  </header>

  <main class="wrap">
    <section class="cards">
      <div class="card">
        <h3>Clarion Call</h3>
        <p>Chat with office.</p>
        <button id="btnOpenChat2" class="btn">Open Chat</button>
      </div>

      <div class="card">
        <h3>Submit Hours</h3>
        <p>Send your times to office.</p>
      </div>
    </section>

    <!-- Hours section (moved into Output Panel when clicked) -->
    <section style="margin-top:1rem">
      <div id="paneSubmit" class="tabpane">
        <form id="frmHours">
          <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:.6rem">
            <label>Production<br/><input name="production"/></label>
            <label>Location<br/><input name="location"/></label>
            <label>Start (24h)<br/><input name="start_time" placeholder="07:00"/></label>
            <label>Finish (24h)<br/><input name="finish_time" placeholder="19:00"/></label>
            <fieldset style="grid-column:1/-1;border:1px solid rgba(255,255,255,.2);border-radius:.6rem;padding:.5rem">
              <legend>Allowances</legend>
              <label><input type="checkbox" name="meal"/> Meal</label>
              <label><input type="checkbox" name="car"/> Car</label>
              <label><input type="checkbox" name="cell"/> Cell</label>
              <label><input type="checkbox" name="winter_shelter"/> Winter shelter</label>
              <label><input type="checkbox" name="travel"/> Travel</label>
            </fieldset>
          </div>
          <div style="margin-top:.8rem"><button class="btn" type="submit">Submit Hours</button></div>
        </form>

        <h3 style="margin-top:1rem">Recent Submissions</h3>
        <table id="tblMyHours">
          <thead><tr><th>Production</th><th>Location</th><th>Start</th><th>Finish</th><th>Allowances</th><th>Status</th></tr></thead>
          <tbody><tr><td colspan="6">Loading…</td></tr></tbody>
        </table>
      </div>
    </section>

    <!-- Unified Output Panel lives at the bottom -->
    <section id="clarionOutputPanel" class="card card--output" style="display:none">
      <h3 id="opTitle">Output</h3>
      <div id="opBody" style="min-height:140px"></div>
    </section>
  </main>

  <footer>© Clarion Location Services</footer>

  <!-- App scripts (unchanged behavior) -->
  <script type="module" src="/js/env.js"></script>
  <script type="module" src="/js/supabase_client_v58.js"></script>
  <script type="module" src="/js/auth_guard_v58.js"></script>
  <script type="module" src="/js/clarion_chat_widget_v58.js"></script>
  <script type="module" src="/js/lsp_v58.js"></script>

<script type="module" src="/js/identity_v60.js"></script>

<script type="module" src="/js/chat_wake_v60.js"></script>

<script type="module" src="/js/logout_v61.js"></script>
</body>
</html>
